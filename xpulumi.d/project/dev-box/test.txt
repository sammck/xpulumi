Content-Type: multipart/mixed; boundary="@@0@@"

--@@0@@
Content-type: text/cloud-boothook

#!/bin/bash
echo "It works, instance ID = $INSTANCE_ID!!!" > /var/log/my-boothook.log
--@@0@@
Content-type: text/cloud-config

apt:
    sources:
    docker.list: {keyid: 9DC858229FC7DD38854AE2D88D81803C0EBFCD88, source: 'deb [arch=amd64] https://download.docker.com/linux/ubuntu $RELEASE stable'}
fqdn: xhub.mckelvie.org
packages: [jq, awscli, collectd, ca-certificates, curl, gnupg, lsb-release, docker-ce, docker-ce-cli, amazon-ecr-credential-helper]
repo_update: true
repo_upgrade: all
runcmd:
- [bash, -c, 'mkdir -p /root/.docker && chmod 700 /root/.docker && echo ''{"credHelpers":{"492598163938.dkr.ecr.us-west-2.amazonaws.com":"ecr-login","public.ecr.aws":"ecr-login"}}'' > /root/.docker/config.json && chmod 600 /root/.docker/config.json']
- [bash, -c, echo "it works!"]
--@@0@@--
